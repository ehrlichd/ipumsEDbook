<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 IPUMS |  Data Science for Social Scientists: An applied course using IPUMS data  </title>
  <meta name="description" content="This is an open source book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 IPUMS |  Data Science for Social Scientists: An applied course using IPUMS data  " />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is an open source book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 IPUMS |  Data Science for Social Scientists: An applied course using IPUMS data  " />
  
  <meta name="twitter:description" content="This is an open source book. The output format for this example is bookdown::gitbook." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="evaluateexercises.html"/>
<link rel="next" href="unit3.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Beginning of a Syllabus</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-ipums"><i class="fa fa-check"></i>What is IPUMS</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-make-this-course"><i class="fa fa-check"></i>Why make this course</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="course-description.html"><a href="course-description.html"><i class="fa fa-check"></i>Course Description</a>
<ul>
<li class="chapter" data-level="" data-path="course-description.html"><a href="course-description.html#course-aims"><i class="fa fa-check"></i>Course Aims</a></li>
<li class="chapter" data-level="" data-path="course-description.html"><a href="course-description.html#learning-outcomes"><i class="fa fa-check"></i>Learning Outcomes</a></li>
<li class="chapter" data-level="" data-path="course-description.html"><a href="course-description.html#guiding-principles"><i class="fa fa-check"></i>Guiding Principles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="syllabus---overview.html"><a href="syllabus---overview.html"><i class="fa fa-check"></i>Syllabus - Overview</a>
<ul>
<li class="chapter" data-level="" data-path="syllabus---overview.html"><a href="syllabus---overview.html#detailed-syllabus"><i class="fa fa-check"></i>Detailed Syllabus</a>
<ul>
<li class="chapter" data-level="" data-path="syllabus---overview.html"><a href="syllabus---overview.html#unit-1-understanding-and-testing-data"><i class="fa fa-check"></i>Unit 1 Understanding and Testing Data</a></li>
<li class="chapter" data-level="" data-path="syllabus---overview.html"><a href="syllabus---overview.html#unit-2-finding-data-and-asking-questions-using-ipums-data"><i class="fa fa-check"></i>Unit 2 Finding Data and Asking Questions (Using IPUMS Data)</a></li>
<li class="chapter" data-level="" data-path="syllabus---overview.html"><a href="syllabus---overview.html#unit-3-discussing-data-and-student-research"><i class="fa fa-check"></i>Unit 3 Discussing Data and Student Research</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="dev-notes.html"><a href="dev-notes.html"><i class="fa fa-check"></i>DEV NOTES</a></li>
<li class="chapter" data-level="1" data-path="unit1.html"><a href="unit1.html"><i class="fa fa-check"></i><b>1</b> Unit 1: The Basics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="unit1.html"><a href="unit1.html#week-1-intro-to-r-data-types-data-structures-1"><i class="fa fa-check"></i><b>1.1</b> Week 1: Intro to R, data types, data structures</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="unit1.html"><a href="unit1.html#intro-to-r"><i class="fa fa-check"></i><b>1.1.1</b> Intro to R</a></li>
<li class="chapter" data-level="1.1.2" data-path="unit1.html"><a href="unit1.html#data-types"><i class="fa fa-check"></i><b>1.1.2</b> Data Types</a></li>
<li class="chapter" data-level="1.1.3" data-path="unit1.html"><a href="unit1.html#data-structures"><i class="fa fa-check"></i><b>1.1.3</b> Data Structures</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="unit1.html"><a href="unit1.html#week-2-plotting-data"><i class="fa fa-check"></i><b>1.2</b> Week 2: Plotting Data</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="unit1.html"><a href="unit1.html#normal-distributions"><i class="fa fa-check"></i><b>1.2.1</b> Normal Distributions</a></li>
<li class="chapter" data-level="1.2.2" data-path="unit1.html"><a href="unit1.html#what-is-normal"><i class="fa fa-check"></i><b>1.2.2</b> What <em>is</em> normal?</a></li>
<li class="chapter" data-level="1.2.3" data-path="unit1.html"><a href="unit1.html#skews"><i class="fa fa-check"></i><b>1.2.3</b> Skews</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="unit1.html"><a href="unit1.html#week-3-statisitcal-testing-of-simple-data-sets-1"><i class="fa fa-check"></i><b>1.3</b> Week 3: Statisitcal testing of simple data sets</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="unit1.html"><a href="unit1.html#t-tests-anova-chi2"><i class="fa fa-check"></i><b>1.3.1</b> t-tests, ANOVA, chi2</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="unit1.html"><a href="unit1.html#week-4-relationships-between-variables-in-simple-data-sets"><i class="fa fa-check"></i><b>1.4</b> Week 4: Relationships between variables in simple data sets</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="unit1.html"><a href="unit1.html#correlation-linear-regression"><i class="fa fa-check"></i><b>1.4.1</b> Correlation, Linear Regression</a></li>
<li class="chapter" data-level="1.4.2" data-path="unit1.html"><a href="unit1.html#genearlized-linear-model"><i class="fa fa-check"></i><b>1.4.2</b> Genearlized Linear Model</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="unit1.html"><a href="unit1.html#week-5"><i class="fa fa-check"></i><b>1.5</b> Week 5:</a></li>
<li class="chapter" data-level="1.6" data-path="unit1.html"><a href="unit1.html#intro-to-rrstudio"><i class="fa fa-check"></i><b>1.6</b> Intro to R/RStudio</a></li>
<li class="chapter" data-level="1.7" data-path="unit1.html"><a href="unit1.html#reading-data-distributions"><i class="fa fa-check"></i><b>1.7</b> Reading Data / Distributions</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="unit1.html"><a href="unit1.html#what-is-a-normal-distribution"><i class="fa fa-check"></i><b>1.7.1</b> What <em>is</em> a <strong>normal distribution</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introsetup.html"><a href="introsetup.html"><i class="fa fa-check"></i><b>2</b> Intro/Setup</a></li>
<li class="chapter" data-level="3" data-path="engage.html"><a href="engage.html"><i class="fa fa-check"></i><b>3</b> Engage</a></li>
<li class="chapter" data-level="4" data-path="explore.html"><a href="explore.html"><i class="fa fa-check"></i><b>4</b> Explore</a></li>
<li class="chapter" data-level="5" data-path="explain.html"><a href="explain.html"><i class="fa fa-check"></i><b>5</b> Explain</a></li>
<li class="chapter" data-level="6" data-path="elaborate.html"><a href="elaborate.html"><i class="fa fa-check"></i><b>6</b> Elaborate</a></li>
<li class="chapter" data-level="7" data-path="evaluateexercises.html"><a href="evaluateexercises.html"><i class="fa fa-check"></i><b>7</b> Evaluate/Exercises</a></li>
<li class="chapter" data-level="8" data-path="unit2.html"><a href="unit2.html"><i class="fa fa-check"></i><b>8</b> IPUMS</a>
<ul>
<li class="chapter" data-level="8.1" data-path="unit2.html"><a href="unit2.html#week-6-introduction-to-ipums"><i class="fa fa-check"></i><b>8.1</b> Week 6 Introduction to IPUMS</a></li>
<li class="chapter" data-level="8.2" data-path="unit2.html"><a href="unit2.html#exploratory"><i class="fa fa-check"></i><b>8.2</b> Week 7 Exploratory analysis</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="unit2.html"><a href="unit2.html#advanced-exploration---change-over-time"><i class="fa fa-check"></i><b>8.2.1</b> Advanced Exploration - Change Over Time</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="unit2.html"><a href="unit2.html#hypothesis"><i class="fa fa-check"></i><b>8.3</b> Week 8 Hypothesis Testing</a></li>
<li class="chapter" data-level="8.4" data-path="unit2.html"><a href="unit2.html#week-9-statistical-inference-1"><i class="fa fa-check"></i><b>8.4</b> Week 9 Statistical Inference</a></li>
<li class="chapter" data-level="8.5" data-path="unit2.html"><a href="unit2.html#week-10-tbd-1"><i class="fa fa-check"></i><b>8.5</b> Week 10 (TBD)</a></li>
<li class="chapter" data-level="8.6" data-path="unit2.html"><a href="unit2.html#intro-to-ipums-website"><i class="fa fa-check"></i><b>8.6</b> Intro to IPUMS website</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="unit2.html"><a href="unit2.html#background-on-ipums"><i class="fa fa-check"></i><b>8.6.1</b> background on ipums</a></li>
<li class="chapter" data-level="8.6.2" data-path="unit2.html"><a href="unit2.html#navigating-website"><i class="fa fa-check"></i><b>8.6.2</b> navigating website</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="unit2.html"><a href="unit2.html#math-example"><i class="fa fa-check"></i><b>8.7</b> math example</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="unit3.html"><a href="unit3.html"><i class="fa fa-check"></i><b>9</b> Unit 3: Independent Research</a>
<ul>
<li class="chapter" data-level="9.1" data-path="unit3.html"><a href="unit3.html#week-11-students-develop-research-question-1"><i class="fa fa-check"></i><b>9.1</b> Week 11: Students develop research Question</a></li>
<li class="chapter" data-level="9.2" data-path="unit3.html"><a href="unit3.html#week-12-students-find-relevant-variables-from-ipums-1"><i class="fa fa-check"></i><b>9.2</b> Week 12: Students find relevant variables from IPUMS</a></li>
<li class="chapter" data-level="9.3" data-path="unit3.html"><a href="unit3.html#week-13-students-test-and-evaluate-results-1"><i class="fa fa-check"></i><b>9.3</b> Week 13: Students test and evaluate results</a></li>
<li class="chapter" data-level="9.4" data-path="unit3.html"><a href="unit3.html#week-14-students-prepare-presentations-of-results-1"><i class="fa fa-check"></i><b>9.4</b> Week 14: Students prepare presentations of results</a></li>
<li class="chapter" data-level="9.5" data-path="unit3.html"><a href="unit3.html#week-15-students-present-work-slides-poster-podium-etc-1"><i class="fa fa-check"></i><b>9.5</b> Week 15: Students present work (slides, poster, podium, etc)</a></li>
<li class="chapter" data-level="9.6" data-path="unit3.html"><a href="unit3.html#example-one"><i class="fa fa-check"></i><b>9.6</b> Example one</a></li>
<li class="chapter" data-level="9.7" data-path="unit3.html"><a href="unit3.html#example-two"><i class="fa fa-check"></i><b>9.7</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ex_code.html"><a href="ex_code.html"><i class="fa fa-check"></i><b>10</b> Example RMD code</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ex_code.html"><a href="ex_code.html#core"><i class="fa fa-check"></i><b>10.1</b> Core</a></li>
<li class="chapter" data-level="10.2" data-path="ex_code.html"><a href="ex_code.html#tips"><i class="fa fa-check"></i><b>10.2</b> Tips</a></li>
<li class="chapter" data-level="10.3" data-path="ex_code.html"><a href="ex_code.html#syntax"><i class="fa fa-check"></i><b>10.3</b> Syntax</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="ex_code.html"><a href="ex_code.html#math"><i class="fa fa-check"></i><b>10.3.1</b> Math</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="introsetup-1.html"><a href="introsetup-1.html"><i class="fa fa-check"></i><b>11</b> Intro/Setup</a></li>
<li class="chapter" data-level="12" data-path="engage-1.html"><a href="engage-1.html"><i class="fa fa-check"></i><b>12</b> Engage</a></li>
<li class="chapter" data-level="13" data-path="explore-1.html"><a href="explore-1.html"><i class="fa fa-check"></i><b>13</b> Explore</a></li>
<li class="chapter" data-level="14" data-path="explain-1.html"><a href="explain-1.html"><i class="fa fa-check"></i><b>14</b> Explain</a></li>
<li class="chapter" data-level="15" data-path="elaborate-1.html"><a href="elaborate-1.html"><i class="fa fa-check"></i><b>15</b> Elaborate</a></li>
<li class="chapter" data-level="16" data-path="evaluateexercises-1.html"><a href="evaluateexercises-1.html"><i class="fa fa-check"></i><b>16</b> Evaluate/Exercises</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/ehrlichd/stats_book" target="blank">A link to something useful</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><p><img src="ipums_banner.png" /><br />
Data Science for Social Scientists:<br />
An applied course using IPUMS data <br></p></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="unit2" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> IPUMS<a href="unit2.html#unit2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="week-6-introduction-to-ipums" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Week 6 Introduction to IPUMS<a href="unit2.html#week-6-introduction-to-ipums" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="exploratory" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Week 7 Exploratory analysis<a href="unit2.html#exploratory" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you’ve just collected a survey, or other raw data, you may not know what you’re looking for. This is perfectly ok but goes against <em>the scientific method</em> most people learned in grade school (More on that to follow(<strong><em>include_link</em></strong>)).</p>
<p>This unit begins by presenting data/distributions and asking students to begin interpreting the data . visual exploration is encouraged and basic of data manipulation are taught
* <em>EG:</em> how to subset data, how to reshape data, how to recode data, how to convert from one <code>data type</code> to another.</p>
<p>Example lab exercise:</p>
<p>Students given a data set (xls, csv, etc)
* load data, perform manipulations, basic summaries
+ cross tabs
+ group means by a covariate
* inspect data visually
+ <em>DESCRIBE</em> the distribution - is it normal? significant?
* <em>FIND</em> aquestion in the spread of the data
+ how can you test this (maybe small group work)
* write up/ present results
+ think on confounding factors / biases</p>
<div id="advanced-exploration---change-over-time" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Advanced Exploration - Change Over Time<a href="unit2.html#advanced-exploration---change-over-time" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here we demonstrate an approach to looking at how Family Structure (inferred from household relationships) has changed over time.</p>
<div id="setup-load-data" class="section level4 hasAnchor" number="8.2.1.1">
<h4><span class="header-section-number">8.2.1.1</span> Setup / Load Data<a href="unit2.html#setup-load-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Install/update R packages</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="unit2.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ipumsr&quot;</span>)</span>
<span id="cb17-2"><a href="unit2.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>Data extract created online using the datacart system.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="unit2.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ipumsr)</span>
<span id="cb18-2"><a href="unit2.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb18-3"><a href="unit2.html#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="unit2.html#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="unit2.html#cb18-5" aria-hidden="true" tabindex="-1"></a>ddi <span class="ot">&lt;-</span> <span class="fu">read_ipums_ddi</span>(<span class="st">&quot;Data/ipumsi_00005.xml&quot;</span>)</span>
<span id="cb18-6"><a href="unit2.html#cb18-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_ipums_micro</span>(ddi)</span></code></pre></div>
<div id="inspect-the-data" class="section level5 hasAnchor" number="8.2.1.1.1">
<h5><span class="header-section-number">8.2.1.1.1</span> Inspect the Data<a href="unit2.html#inspect-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Using <code>haven</code> labeled values.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="unit2.html#cb19-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>RELATE[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>]</span>
<span id="cb19-2"><a href="unit2.html#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(data<span class="sc">$</span>RELATE)</span>
<span id="cb19-3"><a href="unit2.html#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="unit2.html#cb19-4" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="fu">count</span>(RELATE)</span>
<span id="cb19-5"><a href="unit2.html#cb19-5" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> <span class="fu">count</span>(SEX)</span></code></pre></div>
<p>What were those codes ??</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="unit2.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## need to convert this to an image or something similar; kable table?</span></span>
<span id="cb20-2"><a href="unit2.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ipums_view</span>(ddi)</span></code></pre></div>
</div>
<div id="visualize" class="section level5 hasAnchor" number="8.2.1.1.2">
<h5><span class="header-section-number">8.2.1.1.2</span> Visualize<a href="unit2.html#visualize" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>A simple plot</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="unit2.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(AGE <span class="sc">~</span> YEAR, <span class="at">data =</span> data)</span></code></pre></div>
<p>A fancier plot</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="unit2.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(AGE<span class="sc">~</span>YEAR, <span class="at">data =</span> data, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Age by Sex, over Time, CO&quot;</span>)</span>
<span id="cb22-2"><a href="unit2.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(data<span class="sc">$</span>YEAR[data<span class="sc">$</span>SEX<span class="sc">==</span><span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>, data<span class="sc">$</span>AGE[data<span class="sc">$</span>SEX<span class="sc">==</span><span class="dv">1</span>], <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="fu">hsv</span>(.<span class="dv">6</span>,.<span class="dv">6</span>,.<span class="dv">8</span>,.<span class="dv">2</span>))</span>
<span id="cb22-3"><a href="unit2.html#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="unit2.html#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(data<span class="sc">$</span>YEAR[data<span class="sc">$</span>SEX<span class="sc">==</span><span class="dv">2</span>]<span class="sc">+</span><span class="dv">1</span>, data<span class="sc">$</span>AGE[data<span class="sc">$</span>SEX<span class="sc">==</span><span class="dv">2</span>], <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="fu">hsv</span>(<span class="dv">1</span>,.<span class="dv">6</span>,.<span class="dv">8</span>,.<span class="dv">2</span>))</span>
<span id="cb22-5"><a href="unit2.html#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="unit2.html#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(AGE<span class="sc">~</span>YEAR, <span class="at">data =</span> data), <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span></code></pre></div>
</div>
<div id="asking-logical-questions" class="section level5 hasAnchor" number="8.2.1.1.3">
<h5><span class="header-section-number">8.2.1.1.3</span> Asking (logical) questions<a href="unit2.html#asking-logical-questions" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Here we demonstrate how setting up logical questions can be used to easily filter/subset data.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="unit2.html#cb23-1" aria-hidden="true" tabindex="-1"></a>age_test <span class="ot">&lt;-</span> data<span class="sc">$</span>AGE <span class="sc">&gt;</span> <span class="dv">18</span></span>
<span id="cb23-2"><a href="unit2.html#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="unit2.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(age_test)</span>
<span id="cb23-4"><a href="unit2.html#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="unit2.html#cb23-5" aria-hidden="true" tabindex="-1"></a>age_test</span></code></pre></div>
<p>Logical vectors are stored as <code>TRUE</code> or <code>FALSE</code>, but can also be evaluated numerically as <code>1</code> or <code>0</code> respectively. We can therefore <code>sum()</code> the number of <code>TRUE</code> values and divide by total rows for a proportion.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="unit2.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(age_test)<span class="sc">/</span><span class="fu">nrow</span>(data)</span></code></pre></div>
</div>
<div id="hh-vs-persons" class="section level5 hasAnchor" number="8.2.1.1.4">
<h5><span class="header-section-number">8.2.1.1.4</span> HH vs persons<a href="unit2.html#hh-vs-persons" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>A unique characteristic of census and some survey data is the nested-structure with individuals being grouped into households. Often times it is necessary to choose to work at the hh or person level, and data must be appropriately manipulated to fit that case.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="unit2.html#cb25-1" aria-hidden="true" tabindex="-1"></a>hh_total <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(data<span class="sc">$</span>SERIAL))</span>
<span id="cb25-2"><a href="unit2.html#cb25-2" aria-hidden="true" tabindex="-1"></a>hh_total</span>
<span id="cb25-3"><a href="unit2.html#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ipums_view</span>(ddi)</span></code></pre></div>
</div>
</div>
<div id="nuclear-family" class="section level4 hasAnchor" number="8.2.1.2">
<h4><span class="header-section-number">8.2.1.2</span> Nuclear Family<a href="unit2.html#nuclear-family" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First we look at a nuclear family, comprising only parents and their immediate children.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="unit2.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ipumsr)</span>
<span id="cb26-2"><a href="unit2.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb26-3"><a href="unit2.html#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="unit2.html#cb26-4" aria-hidden="true" tabindex="-1"></a>ddi <span class="ot">&lt;-</span> <span class="fu">read_ipums_ddi</span>(<span class="st">&quot;/pkg/ipums/personal/ehrli097/AABA_2022/Data/ipumsi_00005.xml&quot;</span>)</span>
<span id="cb26-5"><a href="unit2.html#cb26-5" aria-hidden="true" tabindex="-1"></a>all_data <span class="ot">&lt;-</span> <span class="fu">read_ipums_micro</span>(ddi)</span>
<span id="cb26-6"><a href="unit2.html#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="unit2.html#cb26-7" aria-hidden="true" tabindex="-1"></a>census_years <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1860</span>, <span class="dv">1870</span>, <span class="dv">1880</span>, <span class="dv">1900</span>, <span class="dv">1910</span>, <span class="dv">1960</span>, <span class="dv">1970</span>, <span class="dv">1980</span>, <span class="dv">1990</span>, <span class="dv">2000</span>, <span class="dv">2010</span>)</span>
<span id="cb26-8"><a href="unit2.html#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="unit2.html#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="do">## subset census only</span></span>
<span id="cb26-10"><a href="unit2.html#cb26-10" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> all_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(YEAR <span class="sc">%in%</span> census_years)</span>
<span id="cb26-11"><a href="unit2.html#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="unit2.html#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="do">## make a household dataframe</span></span>
<span id="cb26-13"><a href="unit2.html#cb26-13" aria-hidden="true" tabindex="-1"></a>hhs <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(YEAR, SERIAL, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(YEAR,SERIAL,GEO1_US)</span>
<span id="cb26-14"><a href="unit2.html#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="unit2.html#cb26-15" aria-hidden="true" tabindex="-1"></a>hhs <span class="sc">%&gt;%</span> <span class="fu">View</span>()</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="unit2.html#cb27-1" aria-hidden="true" tabindex="-1"></a>hhs <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RELATE <span class="sc">==</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="unit2.html#cb27-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-3"><a href="unit2.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-4"><a href="unit2.html#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(YEAR, SERIAL) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">extended_test=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">right_join</span>(hhs, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;YEAR&quot;</span>, <span class="st">&quot;SERIAL&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">extended_test=</span><span class="fu">if_else</span>(<span class="fu">is.na</span>(extended_test),<span class="cn">FALSE</span>,<span class="cn">TRUE</span>))</span>
<span id="cb27-5"><a href="unit2.html#cb27-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-6"><a href="unit2.html#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="unit2.html#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="unit2.html#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="unit2.html#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="unit2.html#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="unit2.html#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="unit2.html#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="unit2.html#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="unit2.html#cb27-14" aria-hidden="true" tabindex="-1"></a>hhs <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>RELATE <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>) <span class="sc">|</span></span>
<span id="cb27-15"><a href="unit2.html#cb27-15" aria-hidden="true" tabindex="-1"></a>                  (RELATE <span class="sc">==</span> <span class="dv">3</span> <span class="sc">&amp;</span></span>
<span id="cb27-16"><a href="unit2.html#cb27-16" aria-hidden="true" tabindex="-1"></a>                     MARST <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>))</span>
<span id="cb27-17"><a href="unit2.html#cb27-17" aria-hidden="true" tabindex="-1"></a>                ) <span class="sc">%&gt;%</span> </span>
<span id="cb27-18"><a href="unit2.html#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="unit2.html#cb27-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-20"><a href="unit2.html#cb27-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-21"><a href="unit2.html#cb27-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(YEAR, SERIAL) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">nuclear_test =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">right_join</span>(hhs, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;YEAR&quot;</span>, <span class="st">&quot;SERIAL&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">nuclear_test =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(nuclear_test), <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb27-22"><a href="unit2.html#cb27-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-23"><a href="unit2.html#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="unit2.html#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="unit2.html#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(hhs<span class="sc">$</span>extended_test,hhs<span class="sc">$</span>nuclear_test)</span></code></pre></div>
<div id="tabulate-results" class="section level5 hasAnchor" number="8.2.1.2.1">
<h5><span class="header-section-number">8.2.1.2.1</span> Tabulate results<a href="unit2.html#tabulate-results" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="unit2.html#cb28-1" aria-hidden="true" tabindex="-1"></a>  hhs <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RELATED <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4200</span>, <span class="dv">4210</span>, <span class="dv">4211</span>, <span class="dv">4220</span>, <span class="dv">4500</span>, <span class="dv">4510</span>, <span class="dv">4600</span>)) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(YEAR, SERIAL) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">parent_test=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">right_join</span>(hhs, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;YEAR&quot;</span>, <span class="st">&quot;SERIAL&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">parent_test=</span><span class="fu">if_else</span>(<span class="fu">is.na</span>(parent_test),<span class="cn">FALSE</span>,<span class="cn">TRUE</span>))</span>
<span id="cb28-2"><a href="unit2.html#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="unit2.html#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="unit2.html#cb28-4" aria-hidden="true" tabindex="-1"></a>  hhs <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RELATED <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4100</span>, <span class="dv">4110</span>, <span class="dv">4120</span>, <span class="dv">4130</span>, <span class="dv">4300</span>, <span class="dv">4301</span>, <span class="dv">4302</span>)) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(YEAR, SERIAL) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">children_test=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">right_join</span>(hhs, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;YEAR&quot;</span>, <span class="st">&quot;SERIAL&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">children_test=</span><span class="fu">if_else</span>(<span class="fu">is.na</span>(children_test),<span class="cn">FALSE</span>,<span class="cn">TRUE</span>))</span>
<span id="cb28-5"><a href="unit2.html#cb28-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-6"><a href="unit2.html#cb28-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-7"><a href="unit2.html#cb28-7" aria-hidden="true" tabindex="-1"></a>  res_tabs <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb28-8"><a href="unit2.html#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;nuclear_test&quot;</span> <span class="ot">=</span> hhs <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR, nuclear_test,GEO1_US) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">.groups=</span><span class="st">&quot;drop&quot;</span>,<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb28-9"><a href="unit2.html#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;extended_test&quot;</span> <span class="ot">=</span> hhs <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR, extended_test, GEO1_US) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">.groups=</span><span class="st">&quot;drop&quot;</span>,<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb28-10"><a href="unit2.html#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;parent_test&quot;</span> <span class="ot">=</span> hhs <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR, parent_test, GEO1_US) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">.groups=</span><span class="st">&quot;drop&quot;</span>,<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb28-11"><a href="unit2.html#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;children_test&quot;</span> <span class="ot">=</span> hhs <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR, children_test, GEO1_US) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">.groups=</span><span class="st">&quot;drop&quot;</span>,<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb28-12"><a href="unit2.html#cb28-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-13"><a href="unit2.html#cb28-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-14"><a href="unit2.html#cb28-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-15"><a href="unit2.html#cb28-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-16"><a href="unit2.html#cb28-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-17"><a href="unit2.html#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="unit2.html#cb28-18" aria-hidden="true" tabindex="-1"></a>collapsed_results <span class="ot">&lt;-</span> res_tabs <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="cf">function</span>(x){</span>
<span id="cb28-19"><a href="unit2.html#cb28-19" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">names</span>(x)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">.groups=</span><span class="st">&quot;drop&quot;</span>,<span class="at">n =</span> <span class="fu">sum</span>(n))</span>
<span id="cb28-20"><a href="unit2.html#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="unit2.html#cb28-21" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb28-22"><a href="unit2.html#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="unit2.html#cb28-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-24"><a href="unit2.html#cb28-24" aria-hidden="true" tabindex="-1"></a>collapsed_results <span class="ot">&lt;-</span> <span class="fu">lapply</span>(collapsed_results, <span class="cf">function</span>(x){</span>
<span id="cb28-25"><a href="unit2.html#cb28-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;test&quot;</span></span>
<span id="cb28-26"><a href="unit2.html#cb28-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(x)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">&quot;state&quot;</span></span>
<span id="cb28-27"><a href="unit2.html#cb28-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb28-28"><a href="unit2.html#cb28-28" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb28-29"><a href="unit2.html#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="unit2.html#cb28-30" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> collapsed_results <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">reduce</span>(full_join, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;YEAR&quot;</span>, <span class="st">&quot;test&quot;</span>, <span class="st">&quot;state&quot;</span>))</span>
<span id="cb28-31"><a href="unit2.html#cb28-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-32"><a href="unit2.html#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="unit2.html#cb28-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-34"><a href="unit2.html#cb28-34" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(combined) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;YEAR&quot;</span>,<span class="st">&quot;test&quot;</span>, <span class="st">&quot;state&quot;</span>, <span class="st">&quot;n_nuclear&quot;</span>, <span class="st">&quot;n_extended&quot;</span>, <span class="st">&quot;n_parent&quot;</span>, <span class="st">&quot;n_children&quot;</span>)</span>
<span id="cb28-35"><a href="unit2.html#cb28-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-36"><a href="unit2.html#cb28-36" aria-hidden="true" tabindex="-1"></a>combined[<span class="fu">is.na</span>(combined)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb28-37"><a href="unit2.html#cb28-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-38"><a href="unit2.html#cb28-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-39"><a href="unit2.html#cb28-39" aria-hidden="true" tabindex="-1"></a>to_plot <span class="ot">&lt;-</span> combined <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(YEAR, state) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">n_tot =</span> <span class="fu">sum</span>(n_nuclear)) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">pct =</span>  <span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">&quot;n_&quot;</span>))<span class="sc">/</span>n_tot) <span class="sc">%&gt;%</span> <span class="fu">select</span>(YEAR,test,state,pct)</span></code></pre></div>
</div>
<div id="visualize-nuclear-families" class="section level5 hasAnchor" number="8.2.1.2.2">
<h5><span class="header-section-number">8.2.1.2.2</span> Visualize Nuclear Families<a href="unit2.html#visualize-nuclear-families" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="unit2.html#cb29-1" aria-hidden="true" tabindex="-1"></a>to_plot <span class="ot">&lt;-</span> to_plot <span class="sc">%&gt;%</span> <span class="fu">filter</span>(test<span class="sc">==</span><span class="cn">TRUE</span>)</span>
<span id="cb29-2"><a href="unit2.html#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="unit2.html#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="unit2.html#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="unit2.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(to_plot<span class="sc">$</span>YEAR, to_plot<span class="sc">$</span>pct<span class="sc">$</span>n_nuclear, <span class="at">col =</span> <span class="fu">hsv</span>(.<span class="dv">4</span>, .<span class="dv">6</span>,.<span class="dv">8</span>), <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;prop of hhs&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Nuclear HHs over time in CO&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="extended-family" class="section level4 hasAnchor" number="8.2.1.3">
<h4><span class="header-section-number">8.2.1.3</span> Extended Family<a href="unit2.html#extended-family" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Next we look at hhs with extended families present. IE, any that contain more relationships than just Parent/Child/Sibling (between children only)</p>
<div id="gernerate-models" class="section level5 hasAnchor" number="8.2.1.3.1">
<h5><span class="header-section-number">8.2.1.3.1</span> Gernerate models<a href="unit2.html#gernerate-models" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="unit2.html#cb30-1" aria-hidden="true" tabindex="-1"></a>to_plot <span class="ot">&lt;-</span> to_plot <span class="sc">%&gt;%</span> <span class="fu">filter</span>(test<span class="sc">==</span><span class="cn">TRUE</span>)</span>
<span id="cb30-2"><a href="unit2.html#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="unit2.html#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="unit2.html#cb30-4" aria-hidden="true" tabindex="-1"></a>glm_hist <span class="ot">&lt;-</span> <span class="fu">glm</span>(pct<span class="sc">$</span>n_extended <span class="sc">~</span> YEAR, <span class="at">data =</span> to_plot[to_plot<span class="sc">$</span>YEAR <span class="sc">&lt;</span> <span class="dv">1950</span>,], <span class="at">family =</span> <span class="fu">quasibinomial</span>(<span class="at">link=</span>logit))</span>
<span id="cb30-5"><a href="unit2.html#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="unit2.html#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="unit2.html#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="unit2.html#cb30-8" aria-hidden="true" tabindex="-1"></a>glm_hist_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1860</span>, <span class="at">to =</span> <span class="dv">1910</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb30-9"><a href="unit2.html#cb30-9" aria-hidden="true" tabindex="-1"></a>glm_hist_y <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm_hist, <span class="fu">list</span>(<span class="at">YEAR =</span> glm_hist_x), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb30-10"><a href="unit2.html#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="unit2.html#cb30-11" aria-hidden="true" tabindex="-1"></a>glm_mod <span class="ot">&lt;-</span> <span class="fu">glm</span>(pct<span class="sc">$</span>n_extended <span class="sc">~</span> YEAR, <span class="at">data =</span> to_plot[to_plot<span class="sc">$</span>YEAR<span class="sc">&gt;</span> <span class="dv">1950</span>,], <span class="at">family =</span> <span class="fu">quasibinomial</span>(<span class="at">link=</span>logit))</span>
<span id="cb30-12"><a href="unit2.html#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="unit2.html#cb30-13" aria-hidden="true" tabindex="-1"></a>glm_mod_x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1960</span>, <span class="at">to =</span> <span class="dv">2010</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb30-14"><a href="unit2.html#cb30-14" aria-hidden="true" tabindex="-1"></a>glm_mod_y <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm_mod, <span class="fu">list</span>(<span class="at">YEAR =</span> glm_mod_x), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb30-15"><a href="unit2.html#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="unit2.html#cb30-16" aria-hidden="true" tabindex="-1"></a>mods <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;hist&quot;</span><span class="ot">=</span><span class="fu">list</span>(),</span>
<span id="cb30-17"><a href="unit2.html#cb30-17" aria-hidden="true" tabindex="-1"></a>             <span class="st">&quot;mod&quot;</span> <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb30-18"><a href="unit2.html#cb30-18" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb30-19"><a href="unit2.html#cb30-19" aria-hidden="true" tabindex="-1"></a>mods_plots <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;hist&quot;</span><span class="ot">=</span><span class="fu">list</span>(),</span>
<span id="cb30-20"><a href="unit2.html#cb30-20" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;mod&quot;</span> <span class="ot">=</span><span class="fu">list</span>()</span>
<span id="cb30-21"><a href="unit2.html#cb30-21" aria-hidden="true" tabindex="-1"></a>                   )</span>
<span id="cb30-22"><a href="unit2.html#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="unit2.html#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">names</span>(to_plot<span class="sc">$</span>pct)){</span>
<span id="cb30-24"><a href="unit2.html#cb30-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-25"><a href="unit2.html#cb30-25" aria-hidden="true" tabindex="-1"></a>  hist_x <span class="ot">&lt;-</span> to_plot<span class="sc">$</span>YEAR[to_plot<span class="sc">$</span>YEAR <span class="sc">&lt;</span> <span class="dv">1950</span>]</span>
<span id="cb30-26"><a href="unit2.html#cb30-26" aria-hidden="true" tabindex="-1"></a>mod_x <span class="ot">&lt;-</span> to_plot<span class="sc">$</span>YEAR[to_plot<span class="sc">$</span>YEAR <span class="sc">&gt;</span> <span class="dv">1950</span>]</span>
<span id="cb30-27"><a href="unit2.html#cb30-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-28"><a href="unit2.html#cb30-28" aria-hidden="true" tabindex="-1"></a>  mods<span class="sc">$</span>hist[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(pct[[i]] <span class="sc">~</span> YEAR, <span class="at">data =</span> to_plot[to_plot<span class="sc">$</span>YEAR <span class="sc">&lt;</span> <span class="dv">1950</span>,])</span>
<span id="cb30-29"><a href="unit2.html#cb30-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-30"><a href="unit2.html#cb30-30" aria-hidden="true" tabindex="-1"></a>  mods_plots<span class="sc">$</span>hist[[i]] <span class="ot">&lt;-</span> </span>
<span id="cb30-31"><a href="unit2.html#cb30-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> hist_x,</span>
<span id="cb30-32"><a href="unit2.html#cb30-32" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;y&quot;</span> <span class="ot">=</span> <span class="fu">predict</span>(mods<span class="sc">$</span>hist[[i]], </span>
<span id="cb30-33"><a href="unit2.html#cb30-33" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">list</span>(<span class="at">YEAR =</span>hist_x), </span>
<span id="cb30-34"><a href="unit2.html#cb30-34" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb30-35"><a href="unit2.html#cb30-35" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb30-36"><a href="unit2.html#cb30-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-37"><a href="unit2.html#cb30-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-38"><a href="unit2.html#cb30-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-39"><a href="unit2.html#cb30-39" aria-hidden="true" tabindex="-1"></a>  mods<span class="sc">$</span>mod[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(pct[[i]] <span class="sc">~</span> YEAR, <span class="at">data =</span> to_plot[to_plot<span class="sc">$</span>YEAR <span class="sc">&gt;</span> <span class="dv">1950</span>,])</span>
<span id="cb30-40"><a href="unit2.html#cb30-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-41"><a href="unit2.html#cb30-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-42"><a href="unit2.html#cb30-42" aria-hidden="true" tabindex="-1"></a>  mods_plots<span class="sc">$</span>mod[[i]] <span class="ot">&lt;-</span> </span>
<span id="cb30-43"><a href="unit2.html#cb30-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> mod_x,</span>
<span id="cb30-44"><a href="unit2.html#cb30-44" aria-hidden="true" tabindex="-1"></a>               <span class="st">&quot;y&quot;</span> <span class="ot">=</span> <span class="fu">predict</span>(mods<span class="sc">$</span>mod[[i]], </span>
<span id="cb30-45"><a href="unit2.html#cb30-45" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">list</span>(<span class="at">YEAR =</span>mod_x), </span>
<span id="cb30-46"><a href="unit2.html#cb30-46" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb30-47"><a href="unit2.html#cb30-47" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb30-48"><a href="unit2.html#cb30-48" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="visualize-1" class="section level5 hasAnchor" number="8.2.1.3.2">
<h5><span class="header-section-number">8.2.1.3.2</span> Visualize<a href="unit2.html#visualize-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="unit2.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(to_plot<span class="sc">$</span>YEAR, to_plot<span class="sc">$</span>pct<span class="sc">$</span>n_extended, <span class="at">col =</span> <span class="fu">hsv</span>(.<span class="dv">95</span>, .<span class="dv">6</span>,.<span class="dv">8</span>), <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">25</span>), <span class="at">bg =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;pct of hhs with extended family&quot;</span>)</span>
<span id="cb31-2"><a href="unit2.html#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="unit2.html#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="unit2.html#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(glm_hist_x,glm_hist_y, <span class="at">col =</span> <span class="fu">hsv</span>(.<span class="dv">95</span>, .<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb31-5"><a href="unit2.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(glm_mod_x, glm_mod_y, <span class="at">col =</span> <span class="fu">hsv</span>(.<span class="dv">95</span>, .<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb31-6"><a href="unit2.html#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="unit2.html#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="unit2.html#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="unit2.html#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="unit2.html#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(to_plot<span class="sc">$</span>YEAR,</span>
<span id="cb31-11"><a href="unit2.html#cb31-11" aria-hidden="true" tabindex="-1"></a>       to_plot<span class="sc">$</span>pct<span class="sc">$</span>n_extended,</span>
<span id="cb31-12"><a href="unit2.html#cb31-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">23</span>,</span>
<span id="cb31-13"><a href="unit2.html#cb31-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="fu">hsv</span>(.<span class="dv">95</span>,.<span class="dv">6</span>,.<span class="dv">8</span>))</span></code></pre></div>
</div>
</div>
<div id="even-more-detail---maybe-remove" class="section level4 hasAnchor" number="8.2.1.4">
<h4><span class="header-section-number">8.2.1.4</span> Even more DETAIL - maybe remove<a href="unit2.html#even-more-detail---maybe-remove" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="unit2.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ipums_view</span>(ddi)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="unit2.html#cb33-1" aria-hidden="true" tabindex="-1"></a>  hhs <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RELATED <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4200</span>, <span class="dv">4210</span>, <span class="dv">4211</span>, <span class="dv">4220</span>, <span class="dv">4500</span>, <span class="dv">4510</span>, <span class="dv">4600</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="unit2.html#cb33-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-3"><a href="unit2.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(YEAR, SERIAL) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">parent_test=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">right_join</span>(hhs, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;YEAR&quot;</span>, <span class="st">&quot;SERIAL&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">parent_test=</span><span class="fu">if_else</span>(<span class="fu">is.na</span>(parent_test),<span class="cn">FALSE</span>,<span class="cn">TRUE</span>))</span>
<span id="cb33-4"><a href="unit2.html#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="unit2.html#cb33-5" aria-hidden="true" tabindex="-1"></a>  hhs <span class="ot">&lt;-</span> d2 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(RELATED <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4100</span>, <span class="dv">4110</span>, <span class="dv">4120</span>, <span class="dv">4130</span>, <span class="dv">4300</span>, <span class="dv">4301</span>, <span class="dv">4302</span>)) <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(YEAR, SERIAL) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">children_test=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">right_join</span>(hhs, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;YEAR&quot;</span>, <span class="st">&quot;SERIAL&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">children_test=</span><span class="fu">if_else</span>(<span class="fu">is.na</span>(children_test),<span class="cn">FALSE</span>,<span class="cn">TRUE</span>))</span></code></pre></div>
<div id="parents-supporting-parents" class="section level5 hasAnchor" number="8.2.1.4.1">
<h5><span class="header-section-number">8.2.1.4.1</span> Parents Supporting Parents<a href="unit2.html#parents-supporting-parents" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="unit2.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(to_plot<span class="sc">$</span>YEAR, to_plot<span class="sc">$</span>pct<span class="sc">$</span>n_extended, <span class="at">col =</span> <span class="fu">hsv</span>(.<span class="dv">95</span>, .<span class="dv">6</span>,.<span class="dv">8</span>), <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">25</span>), <span class="at">bg =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;pct of hhs with extended family&quot;</span>)</span>
<span id="cb34-2"><a href="unit2.html#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="unit2.html#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="unit2.html#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(glm_hist_x,glm_hist_y, <span class="at">col =</span> <span class="fu">hsv</span>(.<span class="dv">95</span>, .<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb34-5"><a href="unit2.html#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(glm_mod_x, glm_mod_y, <span class="at">col =</span> <span class="fu">hsv</span>(.<span class="dv">95</span>, .<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb34-6"><a href="unit2.html#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="unit2.html#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="unit2.html#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mods_plots<span class="sc">$</span>hist<span class="sc">$</span>n_parent,<span class="at">col =</span> <span class="fu">hsv</span>(.<span class="dv">8</span>, .<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb34-9"><a href="unit2.html#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="unit2.html#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mods_plots<span class="sc">$</span>mod<span class="sc">$</span>n_parent, <span class="at">col =</span> <span class="fu">hsv</span>(.<span class="dv">8</span>, .<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb34-11"><a href="unit2.html#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="unit2.html#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(to_plot<span class="sc">$</span>YEAR,</span>
<span id="cb34-13"><a href="unit2.html#cb34-13" aria-hidden="true" tabindex="-1"></a>       to_plot<span class="sc">$</span>pct<span class="sc">$</span>n_parent,</span>
<span id="cb34-14"><a href="unit2.html#cb34-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">23</span>,</span>
<span id="cb34-15"><a href="unit2.html#cb34-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="fu">hsv</span>(.<span class="dv">8</span>, .<span class="dv">6</span>,.<span class="dv">8</span>))</span>
<span id="cb34-16"><a href="unit2.html#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="unit2.html#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="unit2.html#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(to_plot<span class="sc">$</span>YEAR,</span>
<span id="cb34-19"><a href="unit2.html#cb34-19" aria-hidden="true" tabindex="-1"></a>       to_plot<span class="sc">$</span>pct<span class="sc">$</span>n_extended,</span>
<span id="cb34-20"><a href="unit2.html#cb34-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">23</span>,</span>
<span id="cb34-21"><a href="unit2.html#cb34-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="fu">hsv</span>(.<span class="dv">95</span>,.<span class="dv">6</span>,.<span class="dv">8</span>))</span></code></pre></div>
</div>
<div id="parents-supporting-extended-children" class="section level5 hasAnchor" number="8.2.1.4.2">
<h5><span class="header-section-number">8.2.1.4.2</span> Parents Supporting (extended) children<a href="unit2.html#parents-supporting-extended-children" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="unit2.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(to_plot<span class="sc">$</span>YEAR, to_plot<span class="sc">$</span>pct<span class="sc">$</span>n_extended, <span class="at">col =</span> <span class="fu">hsv</span>(.<span class="dv">95</span>, .<span class="dv">6</span>,.<span class="dv">8</span>), <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">ylim =</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">25</span>), <span class="at">bg =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;pct of hhs with extended family&quot;</span>)</span>
<span id="cb35-2"><a href="unit2.html#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="unit2.html#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="unit2.html#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(glm_hist_x,glm_hist_y, <span class="at">col =</span> <span class="fu">hsv</span>(.<span class="dv">95</span>, .<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb35-5"><a href="unit2.html#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(glm_mod_x, glm_mod_y, <span class="at">col =</span> <span class="fu">hsv</span>(.<span class="dv">95</span>, .<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb35-6"><a href="unit2.html#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="unit2.html#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="unit2.html#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="unit2.html#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mods_plots<span class="sc">$</span>hist<span class="sc">$</span>n_children, <span class="at">col =</span> <span class="fu">hsv</span>(.<span class="dv">55</span>,.<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb35-10"><a href="unit2.html#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="unit2.html#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="unit2.html#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(mods_plots<span class="sc">$</span>mod<span class="sc">$</span>n_children, <span class="at">col =</span> <span class="fu">hsv</span>(.<span class="dv">55</span>,.<span class="dv">3</span>,<span class="dv">1</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb35-13"><a href="unit2.html#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="unit2.html#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="unit2.html#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(to_plot<span class="sc">$</span>YEAR,</span>
<span id="cb35-16"><a href="unit2.html#cb35-16" aria-hidden="true" tabindex="-1"></a>       to_plot<span class="sc">$</span>pct<span class="sc">$</span>n_children,</span>
<span id="cb35-17"><a href="unit2.html#cb35-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">23</span>,</span>
<span id="cb35-18"><a href="unit2.html#cb35-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="fu">hsv</span>(.<span class="dv">55</span>,.<span class="dv">6</span>,.<span class="dv">8</span>))</span>
<span id="cb35-19"><a href="unit2.html#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="unit2.html#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(to_plot<span class="sc">$</span>YEAR,</span>
<span id="cb35-21"><a href="unit2.html#cb35-21" aria-hidden="true" tabindex="-1"></a>       to_plot<span class="sc">$</span>pct<span class="sc">$</span>n_extended,</span>
<span id="cb35-22"><a href="unit2.html#cb35-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch =</span> <span class="dv">23</span>,</span>
<span id="cb35-23"><a href="unit2.html#cb35-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">bg =</span> <span class="fu">hsv</span>(.<span class="dv">95</span>,.<span class="dv">6</span>,.<span class="dv">8</span>))</span></code></pre></div>
</div>
</div>
</div>
</div>
<div id="hypothesis" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Week 8 Hypothesis Testing<a href="unit2.html#hypothesis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If, on the other hand you have an a pre-existing idea you want to test. We can follow the traditional <em>scientific method</em>. With a question in mind, the first question is: where to look. What better place than <a href="https://ipums.org">IPUMS</a>!</p>
<p>Begin introducing navigation of web resources - mainly IPUMS international</p>
<p>Students should become comfortable working through lab exercises:
* Define a question (or be presented with one)
* Download variables from IPUMS (course downloads possible)
* Perform a basic analysis (discussed in Unit 1)
* Generate a <strong>visual argument</strong> for your analysis
+ Include explanation/interpretation/reflection on the question at hand, and the data used
+ Any obvious biases
+ Any obvious confounding factors</p>
</div>
<div id="week-9-statistical-inference-1" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Week 9 Statistical Inference<a href="unit2.html#week-9-statistical-inference-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="week-10-tbd-1" class="section level2 hasAnchor" number="8.5">
<h2><span class="header-section-number">8.5</span> Week 10 (TBD)<a href="unit2.html#week-10-tbd-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Some text to break up the sub-section headers</p>
</div>
<div id="intro-to-ipums-website" class="section level2 hasAnchor" number="8.6">
<h2><span class="header-section-number">8.6</span> Intro to IPUMS website<a href="unit2.html#intro-to-ipums-website" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="background-on-ipums" class="section level3 hasAnchor" number="8.6.1">
<h3><span class="header-section-number">8.6.1</span> background on ipums<a href="unit2.html#background-on-ipums" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="navigating-website" class="section level3 hasAnchor" number="8.6.2">
<h3><span class="header-section-number">8.6.2</span> navigating website<a href="unit2.html#navigating-website" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Find certain (very common) variables to answer (common) social science questions.</p>
<p>We describe our methods in this chapter.</p>
<p>Math can be added in body using usual syntax as follows. This may be useful, particularly for explaining the math side of things.</p>
</div>
</div>
<div id="math-example" class="section level2 hasAnchor" number="8.7">
<h2><span class="header-section-number">8.7</span> math example<a href="unit2.html#math-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math inline">\(p\)</span> is unknown but expected to be around 1/3. Standard error will be approximated</p>
<p><span class="math display">\[
SE = \sqrt(\frac{p(1-p)}{n}) \approx \sqrt{\frac{1/3 (1 - 1/3)} {300}} = 0.027
\]</span></p>
<p>You can also use math in footnotes like this<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. Footnotes are helpful because they re-link to where you left off.</p>
<p>We will approximate standard error to 0.027<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p>The <code>longnote</code> footnote seems particularly useful.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>where we mention <span class="math inline">\(p = \frac{a}{b}\)</span><a href="unit2.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p><span class="math inline">\(p\)</span> is unknown but expected to be around 1/3. Standard error will be approximated</p>
<p><span class="math display">\[
SE = \sqrt(\frac{p(1-p)}{n}) \approx \sqrt{\frac{1/3 (1 - 1/3)} {300}} = 0.027
\]</span><a href="unit2.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="evaluateexercises.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="unit3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ehrlichd/stats_book 10-unit2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
